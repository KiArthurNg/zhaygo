<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, width=device-width" />

    <link rel="stylesheet" href="./css/order.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Noto Sans:wght@400;700&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Noto Sans Tai Le:wght@400&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Noto Sans New Tai Lue:wght@500&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Kaushan Script:wght@400&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@500;700&display=swap"
    />
    <link rel="stylesheet" href="css/profilepic.css">
    <link rel="stylesheet" href="css/dropdown.css">
  </head>
  <style>
    .payment-page-02 {
    
    gap: var(--gap-78xl);
   
}
  table {
    width: 90%;
    border-collapse: collapse;
    border-spacing: 0;
    margin-left: auto;
    margin-right: auto;
    align-items: center;
   
  }
  .title {
    position: absolute;
    top: 150px; /* Adjust this value to position it correctly */
    left: 64px;
    color: rgb(219, 97, 3);
    font-size: 27px;
}
  thead {
    background-color: rgb(219, 97, 3);;
   
  }
  th, td {
    padding: 12px 15px;
    text-align: left;
    border-bottom: 1px solid rgb(219, 97, 3);
  }
  th {
    background-color:transparent;
    color: black;
    font-size: 20px;
   
  }
  td{
    font-size: 18px;
  }
  tbody tr:hover {
    background-color: #f2f2f2;
  }
  img {
    max-width: 100px;
    max-height: 100px;
  }

  </style>
  <body>
    <div class="payment-page-02">
      <main class="lead-developer-wrapper">
        <a class="lead-developer">Lead developer</a>
      </main>
      <header class="frame-parent">
        <div class="instance-wrapper">
          <div class="frame-group">
            <img class="instance-child" alt="" src="./images/group-136.svg" />

            <a class="search">Search</a>
          </div>
        </div>
        <div class="rectangle-parent">
          <div class="frame-child"></div>
          <img
            class="new-logo-1"
            loading="lazy"
            alt=""
            src="./images/new-logo-1@2x.png"
          />

          <img
            class="frame-item"
            loading="lazy"
            alt=""
            src="./images/group-134.svg"
            id="group"
          />
        </div>
        <nav class="frame-wrapper">
          <nav class="home-parent">
            <a class="home" id="homeText">Home</a>
            <a class="menu" id="menuText">Menu</a>
            <div class="about-us-wrapper">
              <a class="about-us" id="aboutUsText">About us</a>
            </div>
            <a class="feedback" id="feedbackText">Feedback</a>
          </nav>
        </nav>
        <img
          class="frame-inner"
          loading="lazy"
          alt=""
          id="profile-image"
          src="./images/images.png"
        />
        <div id="dropdown-menu" class="dropdown-menu">
          <a href="/profile">Profile</a>
          <a href="/payment">Payment History</a>
          <a href="/logout" id="logout">Logout</a>
      </div>
      </header>
      <div class="title">Payment History</div>
      <table>
        <thead>
          <tr>
            <th>Date</th>
            <th>Image</th>
            <th>Curry Name</th>
            <th>Quantity</th>
            <th>Price</th>
          </tr>
        </thead>
        <tbody id="orderTableBody">
          <!-- Table rows will be dynamically added here -->
        </tbody>
      </table>

    <script>
      var popuppersonalInformationText = document.getElementById(
        "popuppersonalInformationText"
      );
      if (popuppersonalInformationText) {
        popuppersonalInformationText.addEventListener("click", function (e) {
          window.location.href = "./profile.html";
        });
      }
      
      var popuppaymentHistoryText = document.getElementById(
        "popuppaymentHistoryText"
      );
      if (popuppaymentHistoryText) {
        popuppaymentHistoryText.addEventListener("click", function (e) {
          window.location.href = '/payment'
        });
      }
      
      var group = document.getElementById("group");
      if (group) {
        group.addEventListener("click", function (e) {
          window.location.href = '/cart'
        });
      }
      
      var homeText = document.getElementById("homeText");
      if (homeText) {
        homeText.addEventListener("click", function (e) {
          window.location.href = '/home'
        });
      }
      
      var menuText = document.getElementById("menuText");
      if (menuText) {
        menuText.addEventListener("click", function (e) {
          window.location.href = '/menu'
        });
      }
      
      var aboutUsText = document.getElementById("aboutUsText");
      if (aboutUsText) {
        aboutUsText.addEventListener("click", function (e) {
          window.location.href = '/home'
        });
      }
      
      var feedbackText = document.getElementById("feedbackText");
      if (feedbackText) {
        feedbackText.addEventListener("click", function (e) {
          window.location.href = "./feedback";
        });
      }
      
      var groupImage = document.getElementById("groupImage");
      if (groupImage) {
        groupImage.addEventListener("click", function () {
          var popup = document.getElementById("frameContainer");
          if (!popup) return;
          var popupStyle = popup.style;
          if (popupStyle) {
            popupStyle.display = "flex";
            popupStyle.zIndex = 100;
            popupStyle.backgroundColor = "rgba(113, 113, 113, 0.3)";
            popupStyle.alignItems = "center";
            popupStyle.justifyContent = "center";
          }
          popup.setAttribute("closable", "");
      
          var onClick =
            popup.onClick ||
            function (e) {
              if (e.target === popup && popup.hasAttribute("closable")) {
                popupStyle.display = "none";
              }
            };
          popup.addEventListener("click", onClick);
        });
      }
      
      var groupContainer = document.getElementById("groupContainer");
      if (groupContainer) {
        groupContainer.addEventListener("click", function (e) {
          // Please sync "Payment page 7" to the project
        });
      }
      
      var groupContainer = document.getElementById("groupContainer");
      if (groupContainer) {
        groupContainer.addEventListener("click", function (e) {
          // Please sync "Payment page 9" to the project
        });
      }
      
      var group68Default = document.getElementById("group68Default");
      if (group68Default) {
        group68Default.addEventListener("click", function (e) {
          // Please sync "Payment page 10" to the project
        });
      }
      </script>
     
      <script>
  const endpoint = 'http://localhost:3000/api/orders';
  const token = localStorage.getItem('token');

  fetch(endpoint, {
      method: 'GET',
      headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${token}`,
      }
  })
  .then(response => {
      if (!response.ok) {
          throw new Error('Network response was not ok');
      }
      return response.json();
  })
  .then(data => {
      const tbody = document.getElementById('orderTableBody');

      // Check if the 'orders' array exists and is not empty
      if (Array.isArray(data.orders) && data.orders.length > 0) {
          // Loop through each order in the 'orders' array
          data.orders.forEach(order => {
              // Create a new row for each order
              const row = document.createElement('tr');
              // Populate the row with order details
              row.innerHTML = `
                  <td>${new Date(order.date).toLocaleDateString()}</td>
                  <td><img src="${order.imageurl}" alt="Curry Image"></td>
                  <td>${order.curry}</td>
                  <td>${order.quantity}</td>
                  <td>${order.price}</td>
              `;
              // Append the row to the table body
              tbody.appendChild(row);
          });
      } else {
          // If no orders are found in the response, display an error message
          console.error('No orders found in the response');
      }
  })
  .catch(error => {
      // Log any errors that occur during the fetch request
      console.error('Error fetching data:', error);
  });
      </script>
     
      </script>
      <script src="js/dropdown.js"></script>
      <script src="js/profile.js"></script>
  </body>
</html>
