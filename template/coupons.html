<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, width=device-width" />

    <link rel="stylesheet" href="./css/order.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Noto Sans:wght@400;700&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Noto Sans Tai Le:wght@400&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Noto Sans New Tai Lue:wght@500&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Kaushan Script:wght@400&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@500;700&display=swap"
    />
    <link rel="stylesheet" href="css/coupon.css">
    <link rel="stylesheet" href="css/gl.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="css/dropdown.css">
    <link rel="stylesheet" href="css/profilepic.css">
  </head>
  <style>
    .expdate-parent input {
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: 100%;
            box-sizing: border-box;
        }
    
.custom-swal-container {
            font-family: 'Arial', sans-serif;
        }
       .payment-method-wrapper{
        width: 100%;
       }

.frame-div{
  width: 100%;
}
        .custom-swal-title {
            color: #000000;
            font-size: 24px;
            font-weight: bold;
        }

        .custom-swal-content {
            color: #000000;
            font-size: 18px;
        }
        div:where(.swal2-container) button:where(.swal2-styled).swal2-confirm{
          background-color: #DB6103;
        }
        .custom-swal-confirm-button {
            background-color: #DB6103;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 10px 24px;
            cursor: pointer;
            font-size: 16px;
        }

        .custom-swal-confirm-button:hover {
            background-color: #07414f;
        }
        .line-wrapper {
            position: relative;
            margin-bottom: 20px;
        }

        .line-wrapper input {
            width: 100%;
            padding: 5px 0; /* Adjust vertical padding as needed */
            border: none;
            font-size: larger;
            outline: none;
            background-color: transparent; /* Remove background color */
            border-bottom: 1px solid #000; /* Add bottom border */
        }
/* Adjust the size of the date input */
.instance-inner input[type="date"] {
    padding: 12px;
    font-size: 20px;
    width: 100%;
    box-sizing: border-box;
    border: 1px solid #ccc;
    border-radius: 4px;
}

/* Optional: Adjust the appearance on hover and focus */
.instance-inner input[type="date"]:hover,
.instance-inner input[type="date"]:focus {
    border-color: #007bff; /* Change border color on hover and focus */
}

        /* Optional: Add hover effect */
        .line-wrapper input:hover {
            border-bottom-color: #555; /* Change border color on hover */
        }

        /* Optional: Add focus effect */
        .line-wrapper input:focus {
            border-bottom-color: #007bff; /* Change border color on focus */
        }
        .expdate{
          font-size: larger;
        }
    .purchase{
      pointer-events: none;
    }
  </style>
  <body>
    <div class="payment-page-02">
      <main class="lead-developer-wrapper">
        <a class="lead-developer">Lead developer</a>
      </main>
      <header class="frame-parent">
        <div class="instance-wrapper">
          <div class="frame-group">
            <img class="instance-child" alt="" src="./images/group-136.svg" />

            <a class="search">Search</a>
          </div>
        </div>
        <div class="rectangle-parent">
          <div class="frame-child"></div>
          <img
            class="new-logo-1"
            loading="lazy"
            alt=""
            src="./images/new-logo-1@2x.png"
          />

          <img
            class="frame-item"
            loading="lazy"
            alt=""
            src="./images/group-134.svg"
            id="group"
          />
        </div>
        <nav class="frame-wrapper">
          <nav class="home-parent">
            <a class="home" id="homeText">Home</a>
            <a class="menu" id="menuText">Menu</a>
            <div class="about-us-wrapper">
              <a class="about-us" id="aboutUsText">About us</a>
            </div>
            <a class="feedback" id="feedbackText"></a>
          </nav>
        </nav>
        <img
          class="frame-inner"
          loading="lazy"
          alt=""
          id="profile-image"
          src="./images/images.png"
          
        />
        <div id="dropdown-menu" class="dropdown-menu">
          <a href="/profile">Profile</a>
          <a href="/payment">Payment History</a>
          <a href="/logout" id="logout">Logout</a>
      </div>
      </header>
    </div>
    <div class="select-your-coupons-wrapper">
        <h2 class="select-your-coupons">Select your Coupons</h2>
      </div>
      <div class="coupon-page-child">
        <div class="frame-div">
          <div class="frame-wrapper1">
            <div class="instance-parent">
              <div class="rectangle-wrapper">
                <div class="instance-item"></div>
              </div>
              <div class="rectangle-container">
                <div class="instance-inner"></div>
              </div>
              <div class="rectangle-frame">
                <div class="rectangle-div"></div>
              </div>
              <div class="rectangle-wrapper1">
                <div class="instance-child1"></div>
              </div>
              <div class="rectangle-wrapper2">
                <div class="instance-child2"></div>
              </div>
              <div class="rectangle-wrapper3">
                <div class="instance-child3"></div>
              </div>
            </div>
          </div>
          <div class="frame-parent1">
            <div class="rectangle-group">
              <div class="frame-child1"></div>
              <div class="frame-child2"></div>
              <b class="b">5%</b>
              <b class="use-this-coupon-container">
                <span>Use </span>
                <span class="this-coupon-any">this Coupon Any</span>
                <span>day</span>
              </b>
            </div>
            <div class="group-div">
              <div class="frame-child3"></div>
              <div class="frame-child4"></div>
              <b class="b1">10%</b>
              <b class="use-this-coupon-container1">
                <span>Use </span>
                <span class="this-coupon-any1">this Coupon Any</span>
                <span>day</span>
              </b>
            </div>
            <div class="rectangle-parent1">
              <div class="frame-child5"></div>
              <div class="frame-child6"></div>
              <b class="b2">15%</b>
              <b class="use-this-coupon-container2">
                <span>Use </span>
                <span class="this-coupon-any2">this Coupon Any</span>
                <span>day</span>
              </b>
            </div>
            <div class="rectangle-parent2">
              <div class="frame-child7"></div>
              <div class="frame-child8"></div>
              <b class="b3">20%</b>
              <b class="use-this-coupon-container3">
                <span>Use </span>
                <span class="this-coupon-any3">this Coupon Any</span>
                <span>day</span>
              </b>
            </div>
            <div class="rectangle-parent3">
              <div class="frame-child9"></div>
              <div class="frame-child10"></div>
              <b class="b4">25%</b>
              <b class="use-this-coupon-container4">
                <span>Use </span>
                <span class="this-coupon-any4">this Coupon Any</span>
                <span>day</span>
              </b>
            </div>
            <div class="rectangle-parent4">
              <div class="frame-child11"></div>
              <div class="frame-child12"></div>
              <b class="b5">30%</b>
              <b class="use-this-coupon-container5">
                <span>Use </span>
                <span class="this-coupon-any5">this Coupon Any</span>
                <span>day</span>
              </b>
            </div>
          </div>
        </div>
      </div>
      <div class="coupon-page-inner1">
        <div class="frame-parent2">
          <div class="frame-wrapper2">
            <div class="rectangle-parent5">
              <div class="frame-child13" id="rectangle"></div>
              <b class="apply">Apply</b>
            </div>
          </div>
          <div class="coupon-added-successfully">Coupon added successfully</div>
        </div>
      </div>
    </div>
    

    <script>
      var popuppersonalInformationText = document.getElementById(
        "popuppersonalInformationText"
      );
      if (popuppersonalInformationText) {
        popuppersonalInformationText.addEventListener("click", function (e) {
          window.location.href = "./profile";
        });
      }
      
      var popuppaymentHistoryText = document.getElementById(
        "popuppaymentHistoryText"
      );
      if (popuppaymentHistoryText) {
        popuppaymentHistoryText.addEventListener("click", function (e) {
          window.location.href = "./payment";
        });
      }
      
      var group = document.getElementById("group");
      if (group) {
        group.addEventListener("click", function (e) {
          window.location.href = "./cart";
        });
      }
      
      var homeText = document.getElementById("homeText");
      if (homeText) {
        homeText.addEventListener("click", function (e) {
          window.location.href = "/home";
        });
      }
      
      var menuText = document.getElementById("menuText");
      if (menuText) {
        menuText.addEventListener("click", function (e) {
          window.location.href = "/menu";
        });
      }
      
      var aboutUsText = document.getElementById("aboutUsText");
      if (aboutUsText) {
        aboutUsText.addEventListener("click", function (e) {
          window.location.href = "/aboutus";
        });
      }
      
      
  
      var groupContainer = document.getElementById("groupContainer");
      if (groupContainer) {
        groupContainer.addEventListener("click", function (e) {
          // Please sync "Payment page 7" to the project
        });
      }
      
      var groupContainer = document.getElementById("groupContainer");
      if (groupContainer) {
        groupContainer.addEventListener("click", function (e) {
          // Please sync "Payment page 9" to the project
        });
      }
      
      var group68Default = document.getElementById("group68Default");
      if (group68Default) {
        group68Default.addEventListener("click", function (e) {
          // Please sync "Payment page 10" to the project
        });
      }
      </script>
      <script>
    document.addEventListener('DOMContentLoaded', function() {
    // Get references to the elements
    const addButton = document.getElementById('add');
    const subButton = document.getElementById('sub');
    const numberElement = document.getElementById('number');
    const subtotalElement = document.getElementById('subtotal');
    const totalElement = document.getElementById('total');

    // Constants
    const initialPrice = 150;
    const deliveryCharge = 90;

    // Function to update prices
    function updatePrices() {
        const quantity = parseInt(numberElement.textContent, 10);
        const subtotal = initialPrice * quantity;
        const total = subtotal + deliveryCharge;
        
        subtotalElement.textContent = `NU. ${subtotal}`;
        totalElement.textContent = `NU. ${total}`;
    }

    // Add event listeners to the buttons
    addButton.addEventListener('click', function() {
        let currentNumber = parseInt(numberElement.textContent, 10);
        numberElement.textContent = currentNumber + 1;
        updatePrices();
    });

    subButton.addEventListener('click', function() {
        let currentNumber = parseInt(numberElement.textContent, 10);
        if (currentNumber > 1) {
            numberElement.textContent = currentNumber - 1;
            updatePrices();
        }
    });

    // Initialize prices
    updatePrices();
});
 // Retrieve the image URL and dish name from localStorage
 const dishImage = localStorage.getItem('dishImage');
    const dishName = localStorage.getItem('dishName');

    // Set the image URL and dish name in the destination page
    document.getElementById('loadedImage').src = dishImage;
    document.getElementById('loadedName').textContent = dishName;
      </script>
      <script>
 const purchaseButton = document.getElementById("purchase");

purchaseButton.addEventListener("click", async function (event) {
    event.preventDefault();

    const curry = document.getElementById('loadedName').textContent;
    const quantity = document.getElementById('number').textContent;
    const price = document.getElementById('total').textContent;
    const imageurl = document.getElementById('loadedImage').src;
    const token = localStorage.getItem('token');

    console.log("asd");
    
    // Define token here

    try {
        const response = await fetch('http://localhost:3000/api/orders', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${token}`,
            },
            body: JSON.stringify({ curry, quantity, price, imageurl }),
        });

        const data = await response.json();

        if (response.ok) {
            showAlert()
            console.log(data);
        } else {
            showError()
        }
    } catch (error) {
        console.error('Error making purchase:', error);
        alert('Internal server error');
    }
});
function showAlert() {
            Swal.fire({
                title: 'Order Placed!',
                text: '',
                icon: 'success',
                confirmButtonText: 'OK',
                customClass: {
                    container: 'custom-swal-container',
                    title: 'custom-swal-title',
                    content: 'custom-swal-content',
                    confirmButton: 'custom-swal-confirm-button',
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    window.location.href = '/menu';
                }
            });
        }
        function showError() {
            Swal.fire({
                title: 'Error!',
                text: 'Try Again',
                icon: 'error',
                confirmButtonText: 'OK',
                customClass: {
                    container: 'custom-swal-container',
                    title: 'custom-swal-title',
                    content: 'custom-swal-content',
                    confirmButton: 'custom-swal-confirm-button',
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    window.location.href = '/order';
                }
            });
        }
      </script>
      <script src="js/dropdown.js"></script>
      <script src="js/profile.js"></script>
  </body>
</html>
